<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>VigÃ­a Jalisco Â· Mapa ciudadano de incidentes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Favicon con emoji de alerta ğŸš¨ -->
  <link
    rel="icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' x='0.1em' font-size='90'>ğŸš¨</text></svg>"
  />

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />

  <!-- Tus estilos -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Aviso inicial -->
  <div id="disclaimer-overlay">
    <div class="disclaimer-backdrop"></div>
    <div class="disclaimer-modal">
      <div class="disclaimer-icon">âš ï¸</div>
      <h2 class="disclaimer-title">AVISO IMPORTANTE</h2>
      <p class="disclaimer-text">
        Este mapa muestra <strong>reportes ciudadanos</strong> sobre incidentes de seguridad en Jalisco.
      </p>
      <p class="disclaimer-text">
        La informaciÃ³n se recopila en tiempo real y
        <strong>puede contener errores, imprecisiones o datos desactualizados</strong>.
        Algunos incidentes podrÃ­an haberse resuelto o la ubicaciÃ³n podrÃ­a no ser exacta.
      </p>
      <p class="disclaimer-text">
        Ãšsalo solo como referencia, <strong>no como fuente oficial</strong>.
      </p>
      <div class="disclaimer-footer">
        Para informaciÃ³n oficial consulta a las autoridades de Jalisco. Emergencias
        <strong>911</strong>.
      </div>
      <button id="disclaimer-accept-btn" class="disclaimer-button">
        ENTENDIDO Â· VER EL MAPA
      </button>
    </div>
  </div>

  <div id="app">
    <header>
      <div class="header-left">
        <h1>
          <span class="icon">ğŸš¨</span>
          <span>Mapa ciudadano de incidentes</span>
        </h1>
        <p>
          No es fuente oficial ni servicio de emergencias. Si estÃ¡s en peligro, llama al 911.
        </p>
      </div>
      <div class="brand-badge">
        <div class="brand-badge-main">
          <span class="icon">ğŸ›°ï¸</span>
          <span>VigÃ­a Jalisco</span>
        </div>
        <div class="brand-badge-sub">Mapa ciudadano en tiempo real</div>
      </div>
    </header>

    <!-- Barra EN VIVO -->
    <div class="live-bar">
      <span class="live-dot"></span>
      <span class="live-text">EN VIVO</span>
      <span class="live-updated" id="live-updated">Actualizadoâ€¦</span>
    </div>

    <div class="main">
      <!-- Sidebar escritorio -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <span>Incidentes reportados</span>
          <span class="count-badge" id="incident-count">0</span>
        </div>

        <div class="tabs">
          <div class="tab active" id="tab-list">Mapa</div>
          <div class="tab" id="tab-report">Reportar</div>
        </div>

        <div class="filter-bar" id="filter-bar">
          <button class="filter-btn active" data-mins="240">4 horas</button>
          <button class="filter-btn" data-mins="60">1 hora</button>
          <button class="filter-btn" data-mins="30">30 min</button>
          <button class="filter-btn" data-mins="10">10 min</button>
          <button class="filter-btn" data-mins="1440">24 h</button>
          <button class="filter-btn" data-mins="0">Todos</button>
        </div>

        <div class="incidents-list" id="incidents-list"></div>

        <div class="report-panel" id="report-panel">
          <div class="field-group">
            <div class="field-label">Tipo de incidente</div>
            <select id="incident-type">
              <option value="">Selecciona...</option>
              <option value="FIRE">ğŸ”¥ Incendio</option>
              <option value="ROADBLOCK">ğŸ›‘ Bloqueo en vialidad</option>
              <option value="TIRESPIKES">ğŸ› Poncha llantas / clavos</option>
              <option value="SHOOTING">ğŸ’¥ Balacera / enfrentamiento</option>
              <option value="CRIME">ğŸ•µï¸â€â™‚ï¸ Robo / secuestro / extorsiÃ³n</option>
              <option value="OTHER">âš ï¸ Otro peligro</option>
            </select>
          </div>

          <div class="field-group">
            <div class="field-label">DescripciÃ³n opcional</div>
            <textarea
              id="incident-desc"
              maxlength="500"
              placeholder="Ejemplo: Incendio de vehÃ­culo, casa, lote baldÃ­o..."
            ></textarea>
          </div>

          <div class="field-group">
            <div class="field-label">Link de evidencia opcional</div>
            <input
              type="text"
              id="incident-evidence"
              placeholder="Enlace a foto, video o noticia"
            />
          </div>

          <div class="field-group">
            <div class="field-label">Foto opcional</div>
            <input type="file" id="incident-photo" accept="image/*" />
          </div>

          <div class="field-group">
            <button
              type="button"
              class="map-pick-btn"
              id="map-pick-btn"
            >
              Haz click aquÃ­ y luego en el mapa para elegir ubicaciÃ³n
            </button>
          </div>

          <button class="submit-btn" id="submit-btn">Enviar reporte</button>
          <div class="status-msg" id="status-msg"></div>
        </div>

        <div class="made-by">
          Hecho por <span>Arnulfo Correa</span> Â·
          <a
            href="https://www.instagram.com/rufoco"
            target="_blank"
            rel="noopener noreferrer"
            >Rufoco</a
          >
        </div>
      </aside>

      <div class="map-container">
        <div id="pick-backdrop"></div>
        <div id="pick-overlay">
          ğŸ“ Haz click donde ocurriÃ³ el incidente<br />
          <span style="font-size: 11px">Click en cualquier lugar del mapa</span>
        </div>
        <div id="map"></div>
      </div>
    </div>

    <!-- Panel mÃ³vil pestaÃ±as Mapa / Reportar -->
    <div id="report-sheet" class="report-sheet">
      <div class="report-sheet-header">
        <div class="report-sheet-header-title">
          <span>ğŸ›°ï¸</span>
          <span>VigÃ­a Jalisco</span>
        </div>
        <button
          id="report-sheet-close"
          style="background: none; border: none; color: #fff; font-size: 18px; cursor: pointer;"
        >
          âœ•
        </button>
      </div>

      <div class="report-sheet-tabs">
        <div id="sheet-tab-map" class="report-sheet-tab active">Mapa</div>
        <div id="sheet-tab-report" class="report-sheet-tab">Reportar</div>
      </div>

      <div class="report-sheet-body">
        <!-- Vista MAPA (lista mÃ³vil) -->
        <div id="sheet-view-map">
          <div class="field-label" style="margin-bottom: 4px;">
            Incidentes reportados
          </div>
          <div
            class="incidents-list mobile-incidents-list"
            id="mobile-incidents-list"
          ></div>
        </div>

        <!-- Vista REPORTAR (formulario mÃ³vil) -->
        <div id="sheet-view-report" style="display: none;">
          <div class="field-group">
            <div class="field-label">Tipo de incidente</div>
            <select id="incident-type-mobile">
              <option value="">Selecciona...</option>
              <option value="FIRE">ğŸ”¥ Incendio</option>
              <option value="ROADBLOCK">ğŸ›‘ Bloqueo en vialidad</option>
              <option value="TIRESPIKES">ğŸ› Poncha llantas / clavos</option>
              <option value="SHOOTING">ğŸ’¥ Balacera / enfrentamiento</option>
              <option value="CRIME">ğŸ•µï¸â€â™‚ï¸ Robo / secuestro / extorsiÃ³n</option>
              <option value="OTHER">âš ï¸ Otro peligro</option>
            </select>
          </div>

          <div class="field-group">
            <div class="field-label">DescripciÃ³n opcional</div>
            <textarea
              id="incident-desc-mobile"
              maxlength="500"
              placeholder="Ejemplo: Incendio de vehÃ­culo, casa, lote baldÃ­o..."
            ></textarea>
          </div>

          <div class="field-group">
            <div class="field-label">Link de evidencia opcional</div>
            <input
              type="text"
              id="incident-evidence-mobile"
              placeholder="Enlace a foto, video o noticia"
            />
          </div>

          <div class="field-group">
            <div class="field-label">Foto opcional</div>
            <input type="file" id="incident-photo-mobile" accept="image/*" />
          </div>

          <div class="field-group">
            <button
              type="button"
              class="map-pick-btn"
              id="map-pick-btn-mobile"
            >
              Toca aquÃ­ y luego en el mapa para elegir ubicaciÃ³n
            </button>
          </div>

          <button class="submit-btn" id="submit-btn-mobile">
            Enviar reporte
          </button>
          <div class="status-msg" id="status-msg-mobile"></div>
        </div>
      </div>

      <div class="report-sheet-footer">
        Hecho por <span>Arnulfo Correa</span> Â·
        <a
          href="https://www.instagram.com/rufoco"
          target="_blank"
          rel="noopener noreferrer"
          >Rufoco</a
        >
      </div>
    </div>

    <!-- BotÃ³n flotante mÃ³vil -->
    <button id="report-fab" class="report-fab">
      <span>ğŸ“</span>
      <span>Mapa / Reportar</span>
    </button>
  </div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- Supabase JS -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.48.0/dist/umd/supabase.js"></script>
  <!-- Tu lÃ³gica -->
  <script src="app.js"></script>
</body>
</html>
